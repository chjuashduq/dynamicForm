# 拖拽式表单生成器使用说明

## 概述

拖拽式表单生成器是一个类似 form-generator 的可视化表单设计工具,提供了更直观、更简单的表单创建方式。

## 功能特点

### 1. 三栏布局设计
- **左侧控件面板**: 显示所有可用的控件类型
- **中间画布区域**: 拖放控件并实时预览表单效果
- **右侧属性面板**: 编辑选中控件的详细属性

### 2. 支持的控件类型
- 📝 文本框 (text)
- 🔢 数字框 (number)
- 🔒 密码框 (password)
- 🔽 下拉框 (dropdown)
- ☑️ 复选框 (checkbox)
- 🔘 单选框 (radio)
- 🔘 按钮 (button)

### 3. 核心功能
- ✅ 拖拽添加控件
- ✅ 点击选中控件
- ✅ 实时属性编辑
- ✅ 控件上下移动排序
- ✅ 删除控件
- ✅ 保存/更新表单配置

## 使用方法

### 启动拖拽式设计器

1. 在表单列表页面,点击顶部的 **"拖拽式设计器"** 按钮
2. 或者点击某个表单的 **"拖拽编辑"** 按钮进行编辑

### 添加控件

**拖拽添加 (推荐)**
1. 从左侧"组件列表"中选择需要的组件
2. 按住鼠标左键,拖动组件到中间的"表单画布"区域
3. 当画布边框变成蓝色时,表示可以放置
4. 松开鼠标,组件自动添加到表单末尾

**提示**: 
- 拖拽时会显示组件的预览图
- 画布区域会高亮显示(蓝色边框)表示可以接收拖放
- 如果画布为空,会显示"拖拽左侧组件到这里"的提示

### 编辑控件属性

1. 在中间画布区域点击要编辑的控件
2. 控件会高亮显示(蓝色边框)
3. 右侧属性面板自动加载该控件的属性
4. 修改属性后点击 **"应用更改"** 按钮

### 控件排序

- 点击控件右侧的 **↑** 按钮向上移动
- 点击控件右侧的 **↓** 按钮向下移动

### 删除控件

点击控件右侧的 **🗑️** 按钮删除该控件

### 保存表单

1. 在顶部输入表单名称
2. 点击 **"保存表单"** 按钮
3. 系统会自动保存到数据库

### 清空表单

点击顶部的 **"清空"** 按钮可以清空所有控件(会弹出确认对话框)

## 属性编辑说明

### 基本属性 (所有控件)
- **控件标识 (key)**: 控件的唯一标识符,用于数据存储和API调用
- **标签文本**: 控件前面显示的文字
- **标签宽度比例**: 标签占整个控件宽度的比例 (0-1)

### 文本框/密码框属性
- **占位符**: 输入框为空时显示的提示文字
- **默认值**: 控件的初始值

### 数字框属性
- **默认值**: 控件的初始数值

### 下拉框/复选框/单选框属性
- **选项列表**: 每行一个选项,格式为 `显示文本|值`
  ```
  男|male
  女|female
  ```

### 按钮属性
- **按钮文本**: 按钮上显示的文字

## 与原配置编辑器的区别

| 特性 | 拖拽式设计器 | 原配置编辑器 |
|------|------------|------------|
| 操作方式 | 拖拽 + 点击 | 表单填写 |
| 学习曲线 | 低,直观易用 | 中,需要理解网格概念 |
| 布局方式 | 自动垂直排列 | 手动网格定位 |
| 适用场景 | 简单表单,快速原型 | 复杂布局,精确控制 |
| 事件配置 | 暂不支持 | 完整支持 |
| 验证配置 | 暂不支持 | 完整支持 |

## 注意事项

1. **控件标识 (key) 必须唯一**: 系统会自动生成,但建议手动修改为有意义的名称
2. **保存前检查**: 确保所有控件的 key 和 label 都已正确设置
3. **兼容性**: 拖拽式设计器生成的配置与原配置编辑器完全兼容
4. **事件和验证**: 目前拖拽式设计器不支持事件和验证配置,如需这些功能请使用原配置编辑器

## 未来计划

- [ ] 支持事件配置
- [ ] 支持验证配置
- [ ] 支持样式自定义
- [ ] 支持控件复制/粘贴
- [ ] 支持撤销/重做
- [ ] 支持模板保存和加载
- [ ] 支持拖拽排序(拖动改变顺序)
- [ ] 支持网格布局模式切换

## 技术实现

### 文件结构
```
qml/config/
├── DragFormBuilder.qml      # 拖拽式表单生成器主组件
└── PropertyPanel.qml         # 属性编辑面板组件
```

### 数据格式
拖拽式设计器生成的配置格式与原系统完全一致:
```json
{
  "grid": {
    "rows": 10,
    "columns": 1,
    "rowSpacing": 10,
    "columnSpacing": 10,
    "rowHeights": [1,1,1,1,1,1,1,1,1,1],
    "columnWidths": [1]
  },
  "controls": [
    {
      "type": "text",
      "key": "username",
      "label": "用户名",
      "placeholder": "请输入",
      "value": "",
      "row": 0,
      "column": 0,
      "rowSpan": 1,
      "colSpan": 1,
      "labelRatio": 0.3
    }
  ]
}
```

## 常见问题

**Q: 拖拽式设计器和原配置编辑器可以混用吗?**
A: 可以。两者生成的配置格式完全一致,可以在拖拽式设计器中创建基础表单,然后在原配置编辑器中添加事件和验证。

**Q: 如何实现复杂的网格布局?**
A: 拖拽式设计器目前只支持单列垂直布局。如需复杂的多列网格布局,请使用原配置编辑器。

**Q: 控件顺序可以调整吗?**
A: 可以。使用控件右侧的 ↑↓ 按钮调整顺序。

**Q: 可以导入现有配置吗?**
A: 可以。点击表单列表中的"拖拽编辑"按钮即可加载现有配置进行编辑。

## 反馈与建议

如有问题或建议,请联系开发团队。
