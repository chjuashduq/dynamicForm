# 按钮配置测试指南

## 修改内容

### 1. 按钮不再显示标签配置
在配置编辑器中编辑按钮时：
- ✅ 不显示"标签"输入框
- ✅ 不显示"标签比例"设置
- ✅ 按钮的 label 自动设置为空字符串
- ✅ 按钮的 labelRatio 自动设置为 0

### 2. 按钮在表单中不显示标签位置
在 FormPreview（新增记录页面）中：
- ✅ 按钮不创建标签组件
- ✅ 按钮占据整个容器宽度
- ✅ 不保留标签的空白位置

## 测试步骤

### 测试1：配置编辑器中的按钮

1. 打开配置编辑器
2. 添加一个新的按钮控件
3. 点击编辑按钮
4. **预期结果：**
   - ✅ "基本属性"面板中不显示"标签"输入框
   - ✅ "基本属性"面板中不显示"标签比例"设置
   - ✅ 只显示：标识、行、列、行跨度、列跨度

### 测试2：按钮在表单中的显示

1. 在配置编辑器中创建一个表单，包含：
   - 一个文本输入框（有标签）
   - 一个按钮

2. 保存配置

3. 打开 FormPreview（新增记录页面）

4. **预期结果：**
   - ✅ 文本输入框：左侧显示标签，右侧显示输入框
   - ✅ 按钮：占据整行，没有标签位置

### 测试3：对比效果

**修改前：**
```
[标签位置(空白)]  [按钮]
```

**修改后：**
```
[按钮占据整行]
```

## 代码变更说明

### 1. ControlFactory.qml

```javascript
function _createLabel(container, config) {
    // 按钮类型不创建标签
    if (config.type === "button") {
        return null
    }
    
    // 其他类型正常创建标签
    var label = labelComponent.createObject(container)
    // ...
}
```

### 2. BasicPropertiesPanel.qml

**隐藏标签输入框：**
```qml
Label { 
    text: "标签:" 
    visible: editConfig.type !== "button"  // 按钮不需要标签
}
TextField {
    id: editLabelField
    visible: editConfig.type !== "button"  // 按钮不需要标签
}
```

**getConfig 函数：**
```javascript
function getConfig() {
    var config = { /* ... */ };
    
    // 按钮类型不需要标签和标签比例
    if (editConfig.type === "button") {
        config.label = "";
        config.labelRatio = 0;
    } else {
        config.label = editLabelField.text;
        config.labelRatio = editLabelRatioSpinBox.value / 100.0;
    }
    
    return config;
}
```

## 注意事项

### 1. 现有配置的兼容性

如果你之前创建的按钮配置中有 label 和 labelRatio：
- 重新编辑并保存按钮后，这些值会被清空
- 或者手动编辑 JSON 配置文件，将按钮的 label 设为 ""，labelRatio 设为 0

### 2. 按钮文本的设置

按钮的显示文本不是通过 label 设置，而是通过：
- **text 属性**：在"控件类型编辑器"中设置
- 或者在 JSON 配置中设置 `"text": "按钮文本"`

### 3. 按钮的布局

按钮现在会占据整个容器宽度，如果需要调整按钮的宽度：
- 使用列跨度（colSpan）来控制按钮占据的列数
- 使用网格布局来控制按钮的位置

## 示例配置

### 正确的按钮配置

```json
{
    "type": "button",
    "key": "submitBtn",
    "label": "",           // 空字符串
    "text": "提交",        // 按钮显示的文本
    "labelRatio": 0,       // 0
    "row": 5,
    "column": 0,
    "rowSpan": 1,
    "colSpan": 2,
    "events": {
        "onClicked": "// 点击事件代码"
    }
}
```

### 对比：文本输入框配置

```json
{
    "type": "text",
    "key": "name",
    "label": "姓名",       // 有标签文本
    "labelRatio": 0.3,     // 标签占30%宽度
    "row": 0,
    "column": 0,
    "rowSpan": 1,
    "colSpan": 2
}
```

## 常见问题

### Q1: 按钮文本在哪里设置？

**A:** 在"控件类型编辑器"中设置按钮的 text 属性，或者在 JSON 配置中设置 `"text": "按钮文本"`。

### Q2: 为什么按钮不需要标签？

**A:** 按钮本身就有文本显示，不需要额外的标签。标签是用于描述输入框的，而按钮是用于触发操作的。

### Q3: 如何让按钮居中显示？

**A:** 可以通过调整按钮的列跨度和位置来实现。例如：
- 如果网格有4列，让按钮从第2列开始，跨2列
- 或者使用样式设置按钮的对齐方式

### Q4: 现有的按钮配置会受影响吗？

**A:** 
- 在 FormPreview 中，现有按钮会正常显示（不显示标签位置）
- 在配置编辑器中，重新编辑并保存按钮后，label 和 labelRatio 会被清空

## 总结

这次修改让按钮的配置更加简洁和合理：
1. ✅ 配置界面更清晰（不显示不需要的选项）
2. ✅ 表单显示更美观（按钮占据整行）
3. ✅ 配置数据更规范（按钮的 label 为空，labelRatio 为 0）
